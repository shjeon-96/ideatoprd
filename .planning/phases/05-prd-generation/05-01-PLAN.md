---
phase: 05-prd-generation
plan: 01
type: execute
depends_on: []
files_modified:
  - package.json
  - src/shared/lib/ai/anthropic.ts
  - src/features/prd-generation/lib/prompts/system.ts
  - .env.example
---

<objective>
AI SDK 설치 및 Claude 클라이언트 설정

Purpose: Vercel AI SDK + @ai-sdk/anthropic 기반 Claude API 통합 인프라 구축
Output: Claude 클라이언트 설정 + 시스템 프롬프트 기반 구조
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-prd-generation/05-RESEARCH.md

# Phase 4 결과 - DB 타입 활용
@src/entities/index.ts

# 기존 FSD 구조 참고
@src/features/auth/index.ts

**Tech stack available:** Supabase, Next.js 16, Tailwind v4, shadcn/ui
**Established patterns:** FSD 아키텍처, Server/Client component 분리
**Constraining decisions:**
- Phase 4: Supabase 타입 자동 생성 패턴 확립
- Research: Vercel AI SDK + @ai-sdk/anthropic 표준 스택 선정
</context>

<tasks>

<task type="auto">
  <name>Task 1: AI SDK 패키지 설치</name>
  <files>package.json</files>
  <action>
    Vercel AI SDK 코어 + Anthropic 프로바이더 설치:
    ```bash
    npm install ai @ai-sdk/anthropic @ai-sdk/react
    ```

    - `ai`: Vercel AI SDK 코어 (streamText, convertToModelMessages)
    - `@ai-sdk/anthropic`: Claude 프로바이더
    - `@ai-sdk/react`: useChat hook (클라이언트 상태 관리)

    주의: zod는 이미 shadcn/ui에서 설치되어 있을 수 있음, 없으면 추가
  </action>
  <verify>npm ls ai @ai-sdk/anthropic @ai-sdk/react 실행 시 버전 출력</verify>
  <done>AI SDK 3개 패키지 설치 완료, package.json에 dependencies 추가됨</done>
</task>

<task type="auto">
  <name>Task 2: Claude 클라이언트 설정</name>
  <files>src/shared/lib/ai/anthropic.ts, .env.example</files>
  <action>
    1. src/shared/lib/ai/anthropic.ts 생성:
    ```typescript
    import { anthropic } from '@ai-sdk/anthropic';

    // Default model (cost-effective)
    export const defaultModel = anthropic('claude-3-5-haiku-latest');

    // Advanced model (higher quality PRD)
    export const advancedModel = anthropic('claude-sonnet-4-20250514');

    // Model configuration
    export const AI_CONFIG = {
      maxTokens: 8192,        // PRD is long document
      temperature: 0.7,       // Balance creativity/consistency
      topP: 0.95,
    } as const;
    ```

    2. .env.example에 ANTHROPIC_API_KEY 추가

    주의:
    - SDK는 자동으로 ANTHROPIC_API_KEY 환경변수 사용
    - Edge Runtime 호환 (직접 SDK 설정 없이 provider 함수 사용)
  </action>
  <verify>TypeScript 컴파일 에러 없음 (npm run build)</verify>
  <done>Claude 클라이언트 모듈 생성, 환경변수 템플릿 업데이트</done>
</task>

<task type="auto">
  <name>Task 3: PRD 시스템 프롬프트 기반 구조 생성</name>
  <files>src/features/prd-generation/lib/prompts/system.ts, src/features/prd-generation/index.ts</files>
  <action>
    1. src/features/prd-generation/lib/prompts/system.ts 생성:
    ```typescript
    export const PRD_SYSTEM_PROMPT = `
    You are a professional product manager with 10+ years of experience.
    Your task is to generate a comprehensive PRD (Product Requirements Document).

    <output_format>
    Generate the PRD in Markdown format with the following sections:
    1. Executive Summary
    2. Problem Statement
    3. Target Users & Personas
    4. Requirements (Functional & Non-Functional)
    5. User Stories
    6. Success Metrics (KPIs)
    7. Technical Considerations
    8. Timeline & Milestones
    9. Risks & Mitigation
    </output_format>

    <guidelines>
    - Be specific and actionable
    - Include measurable success criteria
    - Consider edge cases and error scenarios
    - Prioritize features using MoSCoW method (Must/Should/Could/Won't)
    - Use concrete examples where helpful
    </guidelines>

    <language>
    - Write the PRD in Korean (한국어)
    - Use technical terms in English where appropriate
    </language>
    `;

    export const getSystemPrompt = (templateType: string) => {
      // Template-specific prompts will be added in Plan 02
      return PRD_SYSTEM_PROMPT;
    };
    ```

    2. src/features/prd-generation/index.ts (barrel export):
    ```typescript
    export { PRD_SYSTEM_PROMPT, getSystemPrompt } from './lib/prompts/system';
    ```

    주의:
    - XML 태그로 구조화 (Claude 권장 패턴)
    - 한국어 출력 지시 포함
  </action>
  <verify>import { getSystemPrompt } from '@/src/features/prd-generation' 성공</verify>
  <done>시스템 프롬프트 모듈 생성, feature barrel export 설정</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm ls ai @ai-sdk/anthropic @ai-sdk/react` 성공
- [ ] `npm run build` 에러 없음
- [ ] src/shared/lib/ai/anthropic.ts 존재
- [ ] src/features/prd-generation/lib/prompts/system.ts 존재
- [ ] .env.example에 ANTHROPIC_API_KEY 포함
</verification>

<success_criteria>
- AI SDK 패키지 3개 설치됨
- Claude 클라이언트 모듈 생성됨
- 시스템 프롬프트 기반 구조 완성
- TypeScript 빌드 성공
</success_criteria>

<output>
After completion, create `.planning/phases/05-prd-generation/05-01-SUMMARY.md`
</output>
