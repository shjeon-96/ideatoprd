---
phase: 03-authentication
plan: 03
type: execute
depends_on: ["03-02"]
files_modified:
  - app/(auth)/login/page.tsx
  - app/(auth)/signup/page.tsx
  - app/(auth)/layout.tsx
  - src/features/auth/ui/login-form.tsx
  - src/features/auth/ui/signup-form.tsx
  - src/features/auth/ui/oauth-button.tsx
  - src/features/auth/actions/auth-actions.ts
  - src/features/auth/index.ts
---

<objective>
로그인 및 회원가입 페이지 구현

Purpose: 사용자가 Google OAuth 또는 이메일/비밀번호로 인증할 수 있는 UI
Output: /login, /signup 페이지, 인증 폼 컴포넌트, Server Actions
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-authentication/03-02-SUMMARY.md
@.planning/phases/02-ui-foundation/02-01-SUMMARY.md

**Tech from previous phases:**
- shadcn/ui components (Button, Card, Input)
- Supabase server client with cookie handling
- Auth callback routes (/auth/callback, /auth/confirm)
- FSD architecture (features layer)

**UI Guidelines:**
- Neo-editorial aesthetic from Phase 2
- Use existing design tokens (brand-primary, etc.)
- Responsive design
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create auth feature module structure</name>
  <files>
    src/features/auth/index.ts,
    src/features/auth/actions/auth-actions.ts,
    src/features/auth/ui/oauth-button.tsx
  </files>
  <action>
    Set up FSD feature module for authentication:

    1. Create src/features/auth/index.ts
       - Export all public APIs from this feature

    2. Create auth-actions.ts with Server Actions:
       - signInWithEmail(formData: FormData) - Email/password login
       - signUpWithEmail(formData: FormData) - Email/password signup
       - signInWithGoogle() - Redirect to Google OAuth
       - signOut() - Sign out and redirect to home

       Use 'use server' directive
       Use createClient from src/shared/lib/supabase/server
       Use redirect() from next/navigation for redirects
       Use revalidatePath() after auth changes

       IMPORTANT: For Google OAuth, use signInWithOAuth with:
       - provider: 'google'
       - options.redirectTo: `${origin}/auth/callback`

    3. Create oauth-button.tsx:
       - 'use client' component
       - Button with Google icon (from lucide-react or inline SVG)
       - Calls signInWithGoogle action on click
       - Loading state while redirecting
  </action>
  <verify>
    - TypeScript compiles without errors
    - Server Actions use 'use server' directive
  </verify>
  <done>
    - Auth feature module created in FSD structure
    - Server Actions for all auth methods
    - OAuth button component
  </done>
</task>

<task type="auto">
  <name>Task 2: Create login and signup form components</name>
  <files>
    src/features/auth/ui/login-form.tsx,
    src/features/auth/ui/signup-form.tsx
  </files>
  <action>
    Create form components using shadcn/ui:

    1. login-form.tsx:
       - 'use client' component
       - Email input (type="email", name="email", required)
       - Password input (type="password", name="password", required)
       - Submit button with loading state
       - Link to /signup for new users
       - Form action uses signInWithEmail server action
       - Display error messages from searchParams

    2. signup-form.tsx:
       - 'use client' component
       - Email input
       - Password input (min 6 characters)
       - Confirm password input (client-side validation)
       - Submit button with loading state
       - Link to /login for existing users
       - Form action uses signUpWithEmail server action
       - Display success message for email confirmation

    UI styling:
    - Use Card component for form container
    - Use Input component from shadcn/ui
    - Use Button component with brand styling
    - Include OAuth button above form with "또는" divider

    Error handling:
    - Read error from searchParams
    - Display error alert above form
    - Supabase errors: Invalid credentials, User already exists, etc.
  </action>
  <verify>
    - Components render without errors
    - Form validation works (required fields, password match)
  </verify>
  <done>
    - login-form.tsx with email/password form + Google OAuth
    - signup-form.tsx with validation + Google OAuth
    - Both use existing shadcn/ui components
  </done>
</task>

<task type="auto">
  <name>Task 3: Create auth pages and layout</name>
  <files>
    app/(auth)/layout.tsx,
    app/(auth)/login/page.tsx,
    app/(auth)/signup/page.tsx,
    app/auth/error/page.tsx
  </files>
  <action>
    Create auth route group with pages:

    1. app/(auth)/layout.tsx:
       - Centered layout for auth pages
       - Clean background (use paper-texture class)
       - Branding header (IdeaToPRD logo/text)
       - Redirect authenticated users to /dashboard

    2. app/(auth)/login/page.tsx:
       - Import LoginForm from features/auth
       - Pass searchParams for error messages
       - Metadata: title "로그인 | IdeaToPRD"

    3. app/(auth)/signup/page.tsx:
       - Import SignupForm from features/auth
       - Pass searchParams for messages
       - Metadata: title "회원가입 | IdeaToPRD"

    4. app/auth/error/page.tsx:
       - Display error message from searchParams
       - Link back to login
       - Simple error UI

    Route group (auth) keeps URLs clean: /login, /signup (not /auth/login)
  </action>
  <verify>
    - /login page renders
    - /signup page renders
    - /auth/error page renders
    - Authenticated users redirected (once auth works)
  </verify>
  <done>
    - Auth route group with shared layout
    - Login and signup pages
    - Error page for auth failures
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Login and signup pages with:
    - Google OAuth button
    - Email/password forms
    - Neo-editorial styling matching landing page
    - Error handling
  </what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/login
       - Verify login form renders with email/password inputs
       - Verify Google OAuth button is visible
       - Verify "회원가입" link navigates to /signup
    3. Visit: http://localhost:3000/signup
       - Verify signup form with password confirmation
       - Verify "로그인" link navigates to /login
    4. Check styling:
       - Centered card layout
       - Brand colors applied
       - Responsive on mobile (resize browser)

    NOTE: Actual login will fail without Supabase project setup.
    This checkpoint verifies UI only.
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] /login and /signup pages render correctly
- [ ] Forms use Server Actions
- [ ] OAuth button triggers Google redirect attempt
- [ ] UI matches neo-editorial design system
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human verified UI is acceptable
- Auth pages ready for Supabase integration testing
</success_criteria>

<output>
After completion, create `.planning/phases/03-authentication/03-03-SUMMARY.md`
</output>
