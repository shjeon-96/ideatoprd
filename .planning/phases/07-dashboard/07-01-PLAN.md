---
phase: 07-dashboard
plan: 01
type: execute
depends_on: []
files_modified:
  - app/(protected)/dashboard/layout.tsx
  - app/(protected)/dashboard/page.tsx
  - src/widgets/dashboard/sidebar.tsx
  - src/widgets/dashboard/index.ts
  - src/features/prd/api/get-prds.ts
  - src/features/prd/ui/prd-list.tsx
  - src/features/prd/index.ts
ai_context: |
  Phase 7 첫 번째 플랜: 대시보드 레이아웃과 PRD 목록.
  기존 (protected) 레이아웃에 대시보드 중첩 레이아웃 추가.
  prds 테이블의 JSONB 구조와 RLS 정책 활용.
---

# 07-01: Dashboard Layout + PRD List

## Overview

대시보드 사이드바 레이아웃과 PRD 목록 기능을 구현합니다. 기존 `(protected)` 레이아웃 위에 중첩 레이아웃으로 사이드바를 추가하고, PRD 목록을 그리드로 표시합니다.

## Prerequisites

- Phase 6 완료 (Credit System)
- Phase 4의 prds 테이블 및 RLS 정책

<objective>
대시보드 레이아웃 및 PRD 목록 구현

Purpose: 사용자가 생성한 PRD를 조회하고 관리할 수 있는 대시보드 기반 구축
Output: 사이드바 레이아웃, PRD 목록 페이지
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-dashboard/07-RESEARCH.md

@app/(protected)/layout.tsx
@src/entities/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: 대시보드 사이드바 위젯 생성</name>
  <files>src/widgets/dashboard/sidebar.tsx, src/widgets/dashboard/index.ts</files>
  <action>
    1. `src/widgets/dashboard/sidebar.tsx` 생성:
       - 'use client' 지시어
       - lucide-react 아이콘 (Home, FileText, CreditCard, Settings)
       - usePathname으로 현재 경로 활성 상태 표시
       - navItems: Dashboard(/dashboard), My PRDs(/dashboard/prds), Credits(/purchase), Settings(/dashboard/settings)
       - cn() 유틸리티로 조건부 스타일링
       - 활성 상태: bg-primary/10, text-primary, font-medium
       - 비활성 상태: text-muted-foreground, hover:bg-muted

    2. `src/widgets/dashboard/index.ts` barrel export 생성

    AVOID: Settings 링크를 /dashboard/settings 대신 외부 URL로 연결하지 않도록 주의
  </action>
  <verify>npm run build 성공, src/widgets/dashboard/sidebar.tsx 파일 존재</verify>
  <done>Sidebar 컴포넌트 생성, 4개 네비게이션 링크 포함</done>
</task>

<task type="auto">
  <name>Task 2: 대시보드 중첩 레이아웃 생성</name>
  <files>app/(protected)/dashboard/layout.tsx</files>
  <action>
    1. 기존 placeholder page.tsx 대신 layout.tsx 생성
    2. Server Component로 구현 (인증은 상위 (protected)/layout.tsx에서 처리)
    3. 구조:
       - flex 컨테이너 (min-h-[calc(100vh-3.5rem)] 헤더 높이 제외)
       - Sidebar: hidden md:flex, w-64, border-r, shrink-0
       - Main content: flex-1, overflow-auto, p-6
    4. children을 main 영역에 렌더링

    AVOID: Sidebar를 서버 컴포넌트로 감싸지 않도록 주의 (usePathname 사용)
  </action>
  <verify>npm run build 성공, 대시보드 레이아웃 파일 존재</verify>
  <done>대시보드 중첩 레이아웃 생성, 사이드바 + 메인 콘텐츠 영역 구분</done>
</task>

<task type="auto">
  <name>Task 3: PRD 목록 API 함수 및 컴포넌트 생성</name>
  <files>src/features/prd/api/get-prds.ts, src/features/prd/ui/prd-list.tsx, src/features/prd/index.ts</files>
  <action>
    1. `src/features/prd/api/get-prds.ts` 생성:
       - createClient (서버)로 Supabase 클라이언트 생성
       - prds 테이블에서 사용자의 PRD 목록 조회
       - select: id, title, idea, template, version, created_at
       - order by created_at desc
       - RLS가 자동으로 user_id 필터링

    2. `src/features/prd/ui/prd-list.tsx` 생성:
       - Server Component (데이터 페칭 직접)
       - 빈 목록 시: "No PRDs yet" + /generate 링크
       - 목록 있을 때: Card 그리드 (md:grid-cols-2 lg:grid-cols-3)
       - 각 카드: title (line-clamp-1), idea (line-clamp-2), template + date
       - Link로 /dashboard/prds/[id] 연결

    3. `src/features/prd/index.ts` barrel export 생성

    AVOID: 클라이언트 컴포넌트에서 직접 Supabase 쿼리하지 않도록 (RLS 활용을 위해 서버 컴포넌트 사용)
  </action>
  <verify>npm run build 성공, prd feature 모듈 파일들 존재</verify>
  <done>getPrds 함수 생성, PrdList 컴포넌트 생성</done>
</task>

<task type="auto">
  <name>Task 4: 대시보드 홈 페이지 업데이트</name>
  <files>app/(protected)/dashboard/page.tsx</files>
  <action>
    1. 기존 placeholder 내용 대체
    2. Server Component로 유지
    3. 구조:
       - 페이지 제목: "My PRDs"
       - 부제목: "생성한 PRD 목록"
       - 우측 상단: /generate 링크 버튼 ("New PRD")
       - PrdList 컴포넌트 렌더링

    4. 메타데이터 추가: title="Dashboard | IdeaToPRD"

    AVOID: 불필요한 Suspense 없이 Server Component 직접 await 사용
  </action>
  <verify>npm run dev 후 http://localhost:3000/dashboard 접속 확인</verify>
  <done>대시보드 홈 페이지 완성, PRD 목록 표시</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` 성공
- [ ] Dashboard 레이아웃에 사이드바 표시
- [ ] PRD 목록이 그리드로 표시 (또는 빈 상태 메시지)
- [ ] 사이드바 네비게이션 활성 상태 표시 동작
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- 대시보드 레이아웃 + PRD 목록 기능 동작
</success_criteria>

<output>
After completion, create `.planning/phases/07-dashboard/07-01-SUMMARY.md`
</output>
